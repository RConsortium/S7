<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Declare an S3 class — new_S3_class • S7</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Declare an S3 class — new_S3_class"><meta name="description" content="To use an S3 class with S7, you must explicitly declare it using
new_S3_class() because S3 lacks a formal class definition.
(Unless it's an important base class already defined in base_s3_classes.)"><meta property="og:description" content="To use an S3 class with S7, you must explicitly declare it using
new_S3_class() because S3 lacks a formal class definition.
(Unless it's an important base class already defined in base_s3_classes.)"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">S7</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/S7.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/generics-methods.html">Generics and methods</a></li>
    <li><a class="dropdown-item" href="../articles/classes-objects.html">Classes and objects</a></li>
    <li><a class="dropdown-item" href="../articles/compatibility.html">Compatibility with S3 and S4</a></li>
    <li><a class="dropdown-item" href="../articles/packages.html">Using S7 in a package</a></li>
    <li><a class="dropdown-item" href="../articles/motivation.html">Motivation for S7</a></li>
    <li><a class="dropdown-item" href="../articles/performance.html">Performance</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2024/11/s7-0-2-0/">S7 0.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://blog.r-project.org/2024/05/17/generalizing-support-for-functional-oop-in-r/index.html">S7 0.1.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RConsortium/S7/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Declare an S3 class</h1>
      <small class="dont-index">Source: <a href="https://github.com/RConsortium/S7/blob/main/R/S3.R" class="external-link"><code>R/S3.R</code></a></small>
      <div class="d-none name"><code>new_S3_class.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>To use an S3 class with S7, you must explicitly declare it using
<code>new_S3_class()</code> because S3 lacks a formal class definition.
(Unless it's an important base class already defined in <a href="base_s3_classes.html">base_s3_classes</a>.)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">new_S3_class</span><span class="op">(</span><span class="va">class</span>, constructor <span class="op">=</span> <span class="cn">NULL</span>, validator <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-class">class<a class="anchor" aria-label="anchor" href="#arg-class"></a></dt>
<dd><p>S3 class vector (i.e. what <code><a href="https://rdrr.io/r/base/class.html" class="external-link">class()</a></code> returns). For method
registration, you can abbreviate this to a single string, the S3 class
name.</p></dd>


<dt id="arg-constructor">constructor<a class="anchor" aria-label="anchor" href="#arg-constructor"></a></dt>
<dd><p>An optional constructor that can be used to create
objects of the specified class. This is only needed if you wish to
have an S7 class inherit from an S3 class or to use the S3 class as a
property without a default. It must be specified in the
same way as a S7 constructor: the first argument should be <code>.data</code>
(the base type whose attributes will be modified).</p>
<p>All arguments to the constructor should have default values so that
when the constructor is called with no arguments, it returns returns
an "empty", but valid, object.</p></dd>


<dt id="arg-validator">validator<a class="anchor" aria-label="anchor" href="#arg-validator"></a></dt>
<dd><p>An optional validator used by <code><a href="validate.html">validate()</a></code> to check that
the S7 object adheres to the constraints of the S3 class.</p>
<p>A validator is a single argument function that takes the object to
validate and returns <code>NULL</code> if the object is valid. If the object is
invalid, it returns a character vector of problems.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An S7 definition of an S3 class, i.e. a list with class
<code>S7_S3_class</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="method-dispatch-properties-and-unions">Method dispatch, properties, and unions<a class="anchor" aria-label="anchor" href="#method-dispatch-properties-and-unions"></a></h2>
    <p>There are three ways of using S3 with S7 that only require the S3 class
vector:</p><ul><li><p>Registering a S3 method for an S7 generic.</p></li>
<li><p>Restricting an S7 property to an S3 class.</p></li>
<li><p>Using an S3 class in an S7 union.</p></li>
</ul><p>This is easy, and you can usually include the <code>new_S3_class()</code>
call inline:</p>
<p></p><div class="sourceCode R"><pre><code><span><span class="fu"><a href="../reference/method.html">method</a></span><span class="op">(</span><span class="va">my_generic</span>, <span class="fu"><a href="../reference/new_S3_class.html">new_S3_class</a></span><span class="op">(</span><span class="st">"factor"</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="st">"A factor"</span></span>
<span><span class="fu"><a href="../reference/new_class.html">new_class</a></span><span class="op">(</span><span class="st">"MyClass"</span>, properties <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>types <span class="op">=</span> <span class="fu"><a href="../reference/new_S3_class.html">new_S3_class</a></span><span class="op">(</span><span class="st">"factor"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/new_union.html">new_union</a></span><span class="op">(</span><span class="st">"character"</span>, <span class="fu"><a href="../reference/new_S3_class.html">new_S3_class</a></span><span class="op">(</span><span class="st">"factor"</span><span class="op">)</span><span class="op">)</span></span></code></pre><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="extending-an-s-class">Extending an S3 class<a class="anchor" aria-label="anchor" href="#extending-an-s-class"></a></h2>
    <p>Creating an S7 class that extends an S3 class requires more work. You'll
also need to provide a constructor for the S3 class that follows S7
conventions. This means the first argument to the constructor should be
<code>.data</code>, and it should be followed by one argument for each attribute used
by the class.</p>
<p>This can be awkward because base S3 classes are usually heavily wrapped for user
convenience and no low level constructor is available. For example, the
factor class is an integer vector with a character vector of <code>levels</code>, but
there's no base R function that takes an integer vector of values and
character vector of levels, verifies that they are consistent, then
creates a factor object.</p>
<p>You may optionally want to also provide a <code>validator</code> function which will
ensure that <code><a href="validate.html">validate()</a></code> confirms the validity of any S7 classes that build
on this class. Unlike an S7 validator, you are responsible for validating
the types of the attributes.</p>
<p>The following code shows how you might wrap the base Date class.
A Date is a numeric vector with class <code>Date</code> that can be constructed with
<code><a href="https://rdrr.io/r/base/base-internal.html" class="external-link">.Date()</a></code>.</p>
<p></p><div class="sourceCode R"><pre><code><span><span class="va">S3_Date</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_S3_class.html">new_S3_class</a></span><span class="op">(</span><span class="st">"Date"</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">.data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/base-internal.html" class="external-link">.Date</a></span><span class="op">(</span><span class="va">.data</span><span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">self</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric</a></span><span class="op">(</span><span class="va">self</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="st">"Underlying data must be numeric"</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre><p></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># No checking, just used for dispatch</span></span></span>
<span class="r-in"><span><span class="va">Date</span> <span class="op">&lt;-</span> <span class="fu">new_S3_class</span><span class="op">(</span><span class="st">"Date"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">my_generic</span> <span class="op">&lt;-</span> <span class="fu"><a href="new_generic.html">new_generic</a></span><span class="op">(</span><span class="st">"my_generic"</span>, <span class="st">"x"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="method.html">method</a></span><span class="op">(</span><span class="va">my_generic</span>, <span class="va">Date</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="st">"This is a date"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">my_generic</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "This is a date"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Davis Vaughan, Jim Hester, Tomasz Kalinowski, Will Landau, Michael Lawrence, Martin Maechler, Luke Tierney, Hadley Wickham.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

