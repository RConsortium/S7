<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using S7 in a package • S7</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using S7 in a package">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">S7</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/S7.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/generics-methods.html">Generics and methods</a></li>
    <li><a class="dropdown-item" href="../articles/classes-objects.html">Classes and objects</a></li>
    <li><a class="dropdown-item" href="../articles/compatibility.html">Compatibility with S3 and S4</a></li>
    <li><a class="dropdown-item" href="../articles/packages.html">Using S7 in a package</a></li>
    <li><a class="dropdown-item" href="../articles/motivation.html">Motivation for S7</a></li>
    <li><a class="dropdown-item" href="../articles/performance.html">Performance</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2024/11/s7-0-2-0/">S7 0.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://blog.r-project.org/2024/05/17/generalizing-support-for-functional-oop-in-r/index.html">S7 0.1.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RConsortium/S7/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Using S7 in a package</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RConsortium/S7/blob/main/vignettes/packages.Rmd" class="external-link"><code>vignettes/packages.Rmd</code></a></small>
      <div class="d-none name"><code>packages.Rmd</code></div>
    </div>

    
    
<p>This vignette outlines the most important things you need to know
about using S7 in a package. S7 is new, so few people have used it in a
package yet; this means that this vignette is likely incomplete, and
we’d love your help to make it better. Please <a href="https://github.com/RConsortium/S7/issues/new" class="external-link">let us know</a> if
you have questions that this vignette doesn’t answer.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rconsortium.github.io/S7/">S7</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="method-registration">Method registration<a class="anchor" aria-label="anchor" href="#method-registration"></a>
</h2>
<p>You should always call <code><a href="../reference/methods_register.html">methods_register()</a></code> in your
<code>.onLoad()</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">.onLoad</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">S7</span><span class="fu">::</span><span class="fu"><a href="../reference/methods_register.html">methods_register</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>This is S7’s way of registering methods, rather than using export
directives in your <code>NAMESPACE</code> like S3 and S4 do. This is
only strictly necessary if registering methods for generics in other
packages, but there’s no harm in adding it and it ensures that you won’t
forget later. (And if you’re not importing S7 into your namespace it
will quiet an <code>R CMD check</code>
<code>NOTE</code>.<code>)</code></p>
</div>
<div class="section level2">
<h2 id="documentation-and-exports">Documentation and exports<a class="anchor" aria-label="anchor" href="#documentation-and-exports"></a>
</h2>
<p>If you want users to create instances of your class, you will need to
export the class constructor. That means you will also need to document
it, and since the constructor is a function, that means you have to
document the arguments which will be the properties of the class (unless
you have customised the constructor).</p>
<p>If you export a class, you must also set the <code>package</code>
argument, ensuring that classes with the same name are disambiguated
across packages.</p>
<p>You should document generics like regular functions (since they
are!). If you expect others to create their own methods for your
generic, you may want to include an section describing the properties
that you expect all methods to have. We plan to provide an easy way to
document all methods for a generic, but have not yet implemented it. You
can track progress at <a href="https://github.com/RConsortium/S7/issues/167" class="external-link uri">https://github.com/RConsortium/S7/issues/167</a>.</p>
<p>We don’t currently have any recommendations on documenting methods.
There’s no need to document them in order to pass
<code>R CMD check</code>, but obviously there are cases where it’s nice
to provide additional details for a method, particularly if it takes
extra arguments compared to the generic. We’re tracking that issue at <a href="https://github.com/RConsortium/S7/issues/315" class="external-link uri">https://github.com/RConsortium/S7/issues/315</a>.</p>
</div>
<div class="section level2">
<h2 id="backward-compatibility">Backward compatibility<a class="anchor" aria-label="anchor" href="#backward-compatibility"></a>
</h2>
<p>If you are using S7 in a package <em>and</em> you want your package
to work in versions of R before 4.3.0, you need to know that in these
versions of R <code>@</code> only works with S4 objects. There are two
workarounds. The easiest and least convenient workaround is to just
<code><a href="../reference/prop.html">prop()</a></code> instead of <code>@</code>. Otherwise, you can
conditionally make an S7-aware <code>@</code> available to your package
with this custom <code>NAMESPACE</code> directive:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># enable usage of &lt;S7_object&gt;@name in package code</span></span>
<span><span class="co">#' @rawNamespace if (getRversion() &lt; "4.3.0") importFrom("S7", "@")</span></span>
<span><span class="cn">NULL</span></span></code></pre></div>
<p><code>@</code> will work for users of your package because S7
automatically attaches an environment containing the needed definition
when it’s loaded.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Davis Vaughan, Jim Hester, Tomasz Kalinowski, Will Landau, Michael Lawrence, Martin Maechler, Luke Tierney, Hadley Wickham.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
