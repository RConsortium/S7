<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Motivation for S7 • S7</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Motivation for S7">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">S7</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/S7.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/generics-methods.html">Generics and methods</a></li>
    <li><a class="dropdown-item" href="../articles/classes-objects.html">Classes and objects</a></li>
    <li><a class="dropdown-item" href="../articles/compatibility.html">Compatibility with S3 and S4</a></li>
    <li><a class="dropdown-item" href="../articles/packages.html">Using S7 in a package</a></li>
    <li><a class="dropdown-item" href="../articles/motivation.html">Motivation for S7</a></li>
    <li><a class="dropdown-item" href="../articles/performance.html">Performance</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2024/11/s7-0-2-0/">S7 0.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://blog.r-project.org/2024/05/17/generalizing-support-for-functional-oop-in-r/index.html">S7 0.1.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RConsortium/S7/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Motivation for S7</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RConsortium/S7/blob/main/vignettes/motivation.Rmd" class="external-link"><code>vignettes/motivation.Rmd</code></a></small>
      <div class="d-none name"><code>motivation.Rmd</code></div>
    </div>

    
    
<p>R already has two OO systems built-in (S3 and S4) and many additional
OO systems are available in CRAN packages. Why did we decide more work
was needed? This vignette will discuss some of the motivations behind
S7, focussing on the aspects of S3 and S4 that have been found to be
particularly challenging in practice.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rconsortium.github.io/S7/">S7</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="challenges-with-s3">Challenges with S3<a class="anchor" aria-label="anchor" href="#challenges-with-s3"></a>
</h2>
<ul>
<li><p>S3 is very informal, meaning that there’s no formal definition of
a class. This makes it impossible to know exactly which properties an
object should or could possess, or even what its parent class should be.
S7 resolves this problem with a formal definition encoded in a class
object produced by <code><a href="../reference/new_class.html">new_class()</a></code>. This includes support for
validation (and avoiding validation where needed) as inspired by
S4.</p></li>
<li><p>When a new user encounter an S3 generic, they are often confused
because the implementation of the function appears to be missing. S7 has
a thoughtfully designed print method that makes it clear what methods
are available and how to find their source code.</p></li>
<li><p>Properties of an S3 class are usually stored in attributes, but,
by default, <code><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr()</a></code> does partial matching, which can lead to
bugs that are hard to diagnose. Additionally, <code><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr()</a></code>
returns <code>NULL</code> if an attribute doesn’t exist, so misspelling
an attribute can lead to subtle bugs. <code>@</code> fixes both of these
problems.</p></li>
<li><p>S3 method dispatch is complicated for compatibility with S. This
complexity affects relatively little code, but when you attempt to dive
into the details it makes <code><a href="https://rdrr.io/r/base/UseMethod.html" class="external-link">UseMethod()</a></code> hard to understand.
As much as possible, S7 avoids any “funny” business with environments or
promises, so that there is no distinction between argument values and
local values.</p></li>
<li><p>S3 is primarily designed for single dispatch and double dispatch
is only provided for a handful of base generics. It’s not possible to
reuse the implementation for user generics. S7 provides a standard way
of doing multiple dispatch (including double dispatch) that can be used
for any generic.</p></li>
<li><p><code><a href="https://rdrr.io/r/base/UseMethod.html" class="external-link">NextMethod()</a></code> is unpredictable since you can’t tell
exactly which method will be called by only reading the code; you
instead need to know both the complete class hierarchy and what other
methods are currently registered (and loading a package might change
those methods). S7 takes a difference approach with
<code><a href="../reference/super.html">super()</a></code>, requiring explicit specification of the superclass
to be used.</p></li>
<li><p>Conversion between S3 classes is only implemented via loose
convention: if you implement a class <code>foo</code>, then you should
also provide generic <code>as.foo()</code> to convert other objects to
that type. S7 avoids this problem by providing the double-dispatch
<code><a href="../reference/convert.html">convert()</a></code> generic so that you only need to provide the
appropriate methods.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="challenges-with-s4">Challenges with S4<a class="anchor" aria-label="anchor" href="#challenges-with-s4"></a>
</h2>
<ul>
<li><p>Multiple inheritance seemed like a powerful idea at the time, but
in practice it appears to generate more problems than it solves. S7 does
not support multiple inheritance.</p></li>
<li><p>S4’s method dispatch uses a principled but complex distance
metric to pick the best method in the presence of ambiguity. Time has
shown that this approach is hard for people to understand and makes it
hard to predict what will happen when new methods are registered. S7
implements a much simpler, greedy, approach that trades some additional
work on behalf of the class author for a system that is simpler and
easier to understand.</p></li>
<li><p>S4 is a clean break from S3. This made it possible to make
radical changes but it made it harder to switch from S3 to S4, leading
to a general lack of adoption in the R community. S7 is designed to be
drop-in compatible with S3, making it possible to convert existing
packages to use S7 instead of S3 with only an hour or two of
work.</p></li>
</ul>
<!-- --><ul>
<li>At least within Bioconductor, slots are generally thought of as
implementation detail that should not be directly accessed by the
end-user. This leads to two problems. Firstly, implementing an S4
Bioconductor class often also requires a plethora of accessor functions
that are a thin wrapper around <code>@</code> or <code>@&lt;-</code>.
Secondly, users know about <code>@</code> and use it to access object
internals even though they’re not supposed to. S7 avoids these problems
by accepting the fact that R is a data language, and that there’s no way
to stop users from pulling the data they need out of an object. To make
it possible to change the internal implementation details of an object
while preserving existing <code>@</code> usage, S7 provides dynamic
properties.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Davis Vaughan, Jim Hester, Tomasz Kalinowski, Will Landau, Michael Lawrence, Martin Maechler, Luke Tierney, Hadley Wickham.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
